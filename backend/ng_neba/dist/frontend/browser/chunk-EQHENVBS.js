import{a as P}from"./chunk-MICC35WZ.js";import{e as H,j as N,l as k}from"./chunk-64FVLR2L.js";import"./chunk-WXI33M2S.js";import{a as J}from"./chunk-WGOEMV6R.js";import{a as _}from"./chunk-VY32DVZK.js";import{$ as o,Hb as s,Ib as v,Jb as C,Lb as b,Nb as E,Ob as M,Pb as j,Qa as p,Qb as B,V as R,bb as O,bc as y,da as w,gb as I,ib as f,la as g,ma as x,mb as T,nc as z,ob as V,pb as $,qb as r,qc as A,ra as u,rb as a,sb as D,vb as F,yb as h,zb as m}from"./chunk-JFKBKRVP.js";var S=(()=>{let t=class t{constructor(){this.reviews=O([]),this.http=o(_),y(()=>{this.reviews()})}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var L=i=>({"medication-container":!0,grey:i});function U(i,t){if(i&1){let d=F();r(0,"div",0)(1,"div",1)(2,"p"),s(3),a(),r(4,"p"),s(5),a(),r(6,"p"),s(7),a(),r(8,"p"),s(9),M(10,"date"),a()(),r(11,"div",2)(12,"button",3),h("click",function(){g(d);let e=m();return x(e.delete())}),s(13,"Delete"),a(),r(14,"button",4),h("click",function(){g(d);let e=m();return x(e.update())}),s(15,"Update"),a(),r(16,"button",5),h("click",function(){g(d);let e=m();return x(e.goto())}),s(17,"Go to medicine-list"),a()()()}if(i&2){let d,n,e,c,l=m();f("ngClass",E(8,L,l.odd())),p(3),C("review:",(d=l.review())==null?null:d.review,""),p(2),C("rating:",(n=l.review())==null?null:n.rating,"/10"),p(2),C("reviewed by:",(e=l.review())==null||e.by==null?null:e.by.fullname,""),p(2),v(B(10,5,(c=l.review())==null?null:c.date,"medium"))}}function Y(i,t){if(i&1&&(r(0,"div",0)(1,"div",1)(2,"p"),s(3),a(),r(4,"p"),s(5),a(),r(6,"p"),s(7),a(),r(8,"p"),s(9),M(10,"date"),a()()()),i&2){let d,n,e,c,l=m();f("ngClass",E(7,L,l.odd())),p(3),v((d=l.review())==null?null:d.review),p(2),v((n=l.review())==null?null:n.rating),p(2),v((e=l.review())==null||e.by==null?null:e.by.fullname),p(2),v(j(10,5,(c=l.review())==null?null:c.date))}}var G=(()=>{let t=class t{constructor(){this.state=o(P),this.review=u(),this.odd=u(),this.reviews=o(S).reviews,this.med_id=u(),this.navigation=o(H),this.http=o(_),this.notification=o(N),this.is_loggedin=o(P).is_logged_in()}get review_id(){return this.review()?._id}update(){if(this.state.state()._id===this.review()?.by?.user_id)this.navigation.navigate(["","med_route","medications",`${this.med_id()}`,"review-list",this.review_id]);else{this.notification.error("you are not authorized to update others review");return}}goto(){this.navigation.navigate(["","med_route","medication-list"])}delete(){this.http.delete(k.BACKEND_SERVER+`/medications/${this.med_id()}/reviews/${this.review_id}`).subscribe(n=>{if(n.success&&this.state.state()._id===this.review()?.by?.user_id){let e=this.reviews().filter(c=>c._id!==this.review_id);this.reviews.set(e),this.navigation.navigate(["","med_route","medications",`${this.med_id()}`,"review-list"]),this.notification.success("deleted successfully")}else this.notification.error("something went wrong")})}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=w({type:t,selectors:[["app-review"]],inputs:{review:[1,"review"],odd:[1,"odd"],med_id:[1,"med_id"]},standalone:!0,features:[b],decls:2,vars:1,consts:[[3,"ngClass"],[1,"medication-name"],[1,"button-group"],[1,"action-button","delete",3,"click"],[1,"action-button","update",3,"click"],[3,"click"]],template:function(e,c){e&1&&I(0,U,18,10,"div",0)(1,Y,11,9,"div",0),e&2&&T(c.is_loggedin?0:1)},dependencies:[z,A],styles:[".medication-container[_ngcontent-%COMP%]{border-radius:10px;border:1px solid #ddd;background-color:#fff;width:60%;padding:20px;margin:15px auto;box-shadow:0 4px 12px #0000001a;transition:box-shadow .3s ease-in-out}.medication-container[_ngcontent-%COMP%]:hover{box-shadow:0 6px 16px #0003}.medication-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:600;margin-bottom:12px;color:#333}.medication-name[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:4px 0}.button-group[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:10px}.action-button[_ngcontent-%COMP%]{padding:10px 20px;font-size:.95em;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s,transform .3s}.action-button.delete[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff}.action-button.update[_ngcontent-%COMP%]{background-color:#3498db;color:#fff}.action-button.add-review[_ngcontent-%COMP%]{background-color:#2ecc71;color:#fff}.action-button[_ngcontent-%COMP%]:hover{opacity:.85;transform:translateY(-2px)}.grey[_ngcontent-%COMP%]{background-color:gray}"]});let i=t;return i})();var q=(i,t)=>t._id;function Q(i,t){if(i&1&&D(0,"app-review",0),i&2){let d=t.$implicit,n=t.$index,e=m();f("review",d)("med_id",e.id())("odd",n%2!==0)}}var he=(()=>{let t=class t{constructor(){this.id=u(),this.http=o(_),this.medications=o(J).medications(),this.reviews=o(S).reviews,y(()=>this.http.get(k.BACKEND_SERVER+`/medications/${this.id()}/reviews`).subscribe(n=>{n.success&&this.reviews.set(n.data)}))}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=w({type:t,selectors:[["app-reviews"]],inputs:{id:[1,"id"]},standalone:!0,features:[b],decls:2,vars:0,consts:[[3,"review","med_id","odd"]],template:function(e,c){e&1&&V(0,Q,1,3,"app-review",0,q),e&2&&$(c.reviews())},dependencies:[G]});let i=t;return i})();export{he as ReviewsComponent};
